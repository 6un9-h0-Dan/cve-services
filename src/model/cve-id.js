const mongoose = require('mongoose')

const CveIdSchema = new mongoose.Schema({
  _id: false,
  cve_id: String,
  cve_year: String,
  state: String,
  owning_cna: String,
  requested_by: {
    cna: String,
    user: String
  },
  time: {
    created: Date,
    modified: Date,
    reserved: Date
  }
}, { collection: 'Cve-Id', timestamps: { createdAt: 'time.created', updatedAt: 'time.modified' } })

CveIdSchema.query.byCveId = function (cveId) {
  return this.where({ cve_id: new RegExp('^' + cveId + '$', 'i') }) // match cveId exactly (case insensitive)
}

const CveId = mongoose.model('Cve-Id', CveIdSchema)
module.exports = CveId
