const mongoose = require('mongoose');

let CveSchema = new mongoose.Schema({
    id: String,
    cve: Object
}, { collection: 'Cve' });

CveSchema.query.byCveId = function(cve_id) {
    return this.where({ 'cve.CVE_data_meta.ID' : new RegExp( '^' + cve_id + '$', 'i') });             // match cve_id exactly (case insensitive)
};

const Cve = mongoose.model('Cve', CveSchema);
module.exports = Cve;
