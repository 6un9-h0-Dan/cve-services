const express = require('express')
const router = express.Router()
const mw = require('../../middleware/middleware')
const controller = require('./cve-id.controller')

router.get('/cve-id', mw.validateUser, controller.CVEID_GET_FILTER)
router.post('/cve-id', mw.validateUser, mw.onlyCnas, controller.CVEID_RESERVE)
router.get('/cve-id/:id', mw.validateUser, controller.CVEID_GET_SINGLE)
router.post('/cve-id/:id', mw.onlySecretariat, mw.validateUser, controller.CVEID_UPDATE_SINGLE)
router.post('/cve-id-range/:year', mw.onlySecretariat, mw.validateUser, controller.CVEID_RANGE_CREATE)

module.exports = router
