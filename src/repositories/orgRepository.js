const baseRepository = require('./baseRepository')
const Org = require('../model/org')
const utils = require('../utils/utils')

class orgRepository extends baseRepository {
    
    constructor() {
        super(Org)
    }

    async findOneByShortName (shortName) {
        return this.collection.findOne().byShortName(shortName)
    }

    async findOneByUUID (UUID) {
        return this.collection.findOne().byUUID(UUID)
    }

    async getOrgUUID (shortName) {
        return utils.getOrgUUID (shortName)
    }
    
    async updateByOrgUUID (org_UUID, cna, options = {}) {
        if (options) {
            return this.collection.findOneAndUpdate().byUUID(org_UUID).updateOne(cna).setOptions(options)
        } else {
            return this.collection.findOneAndUpdate().byUUID(org_UUID).updateOne(cna)
        }
    }

    async isSecretariat (shortName) {
        return utils.isSecretariat(shortName)
    }

    async isSecretariatUUID (shortName) {
        return utils.isSecretariatUUID(shortName)
    }

}

module.exports = orgRepository;
