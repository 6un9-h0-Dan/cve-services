import { mapValues } from 'lodash';
import { healthCheck } from './controllers/debug-routes/health-check';
import { getAllCves } from './controllers/cve-id-allocation-service/get-all-cves';
import { userAuth } from './controllers/authentication/user-auth';
import { palceUserinOrg } from './controllers/debug-routes/place-user-in-organization';
import { requestCveId } from './controllers/cve-id-allocation-service/request-cve-id';
import { setCveIdStatus } from './controllers/cve-id-allocation-service/set-cve-id-status';
import { getCvsInfo } from './controllers/cve-id-allocation-service/get-cve-info';

export const ROUTES = {
    '/health-check': {
        get: healthCheck,
    },
    '/get-all-cves': {
        get: getAllCves,
    },
    '/user-auth': {
        post: userAuth,
    },
    '/request-cve-id': {
        post: requestCveId,
    },
    '/set-cve-status': {
        post: setCveIdStatus,
    },
    '/get-cvs-info': {
        post: getCvsInfo,
    },
    '/debug-only-palce-user-in-org': {
        //FOR DEV PURPOSE ONLY
        post: palceUserinOrg,
    },
};

export function configureRoutes(app) {
    mapValues(ROUTES, (methods, route) => mapValues(methods, (handler, method) => app[method](route, handler)));
}
